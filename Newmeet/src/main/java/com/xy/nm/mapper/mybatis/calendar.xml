<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- namespace 는 필수 속성이다. : dao 식별하기위한 이름 -->
<mapper namespace="com.xy.nm.calendar.dao.CalDaoInterface">

	<!-- select 결과 메핑을 위한 resultMap 설정 -->
	<resultMap id="resultCalendarInfo"
		type="com.xy.nm.calendar.domain.CalendarInfo">
		<id property="c_idx" column="c_idx" />
		<result property="m_idx" column="m_idx" />
		<result property="c_title" column="c_title" />
		<result property="c_pay" column="c_pay" />
		<result property="c_count" column="c_count" />
		<result property="c_place" column="c_place" />
		<result property="c_address" column="c_address" />
		<result property="c_date" column="c_date" />
		<result property="c_edate" column="c_edate" />
	</resultMap>
	
	
	<insert id="createCalendar" parameterType="com.xy.nm.calendar.domain.CalendarInfo">
		insert into Calendar (m_idx, c_title, c_pay, c_count, c_place, c_address, c_date, c_edate)
		values (#{m_idx}, #{c_title}, #{c_pay}, #{c_count}, #{c_place}, #{c_address}, #{c_date}, #{c_edate})
	</insert>

	<select id="calList" resultMap="resultCalendarInfo">
		select * from Calendar where m_idx=#{m_idx} order by c_date
	</select>


	<select id="selectCalByIdx" resultMap="resultCalendarInfo">
		select * from Calendar where c_idx=#{c_idx}
	</select>
	
	<delete id="deleteCalendar">
		delete from Calendar where c_idx=#{c_idx}
	</delete>
	
	<update id="updateCalendar" parameterType="com.xy.nm.calendar.domain.CalendarInfo">
		update Calendar set c_title=#{c_title}, c_pay=#{c_pay}, c_count=#{c_count}, c_place=#{c_place}, c_address=#{c_address}, c_date=#{c_date}, c_edate=#{c_edate}
		where c_idx=#{c_idx}
	</update>
	
	<insert id="createCalMember" parameterType="int">
		insert into cMember (c_idx, nidx)
		values (#{param1}, #{param2})
	</insert>
	
	<select id="countCalMember" resultType="int">
		select * from cMember where c_idx=#{c_idx}
	</select>
	
	<select id="joinCalMember" resultType="com.xy.nm.calendar.domain.CalJoinMember">
		select * from Member m inner join cMember c on m.nidx=c.nidx where c.c_idx=#{c_idx}
	</select>
	
	<select id="selectCalMember" resultType="int">
		select count(*) from cMember where c_idx=#{param1} and nidx=#{param2}
	</select>
	
</mapper>